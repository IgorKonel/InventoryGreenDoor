# `GreenDoor Inventory`

### Разработчик `Игорь Конышев`

###*Контакты*:
* `Gmail` : dkoneli7@gmail.com
* `VK` : @igorkonel
* `Телефон` : +79645070196


## Короткое описание программы


## Описание программы
 Это программа, написанная на языке Python, для работы с Google
 Sheets API и создания заказов по инвентуре со сборкой в Excel файл 
 в формате xlsx.

GUI написан на встроенной библиотеке Tkinter.
 
 Здесь описывается только то, что уже добавлено и работает.


### Используемые библиотеки
Встроенные
* `Tkinter` - *GUI для ввода новой ссылки на файл*
* `os` - *Открытие таблицы*
* `json` - *Работа с БД*

Установочные
* `google-api-python-client`
* `google-auth-httplib2` (возможно не используется)
* `google-auth-oauthlib` (возможно не используется)
* `oauth2client` (возможно не используется)
* `openpyxl` - *Формирование данных в таблицу и запись в Excel файл*


 
 1. Программа забирает данные из заданной в переменной `sheet_id` таблицы c помощью библиотеки `googleapiclient`
 
 
 2. Формирует из них списки 
       * `resp_house` - список хозов с кол-вом
       * `resp_tea` - список чаев с кол-вом
       * `resp_art_count` - список артикулов и Уп\Шт
       * `order_wd` - список позиций для Лубянки
       * `order_wdl` - список позиций для Сухаревки
 
 
 
 3. Получает конечные `order` списки для заказа путём:
   
   * Удаления позиций с нулевым значением
   * Объединения `resp_house` с `resp_art_count` в единый список
 
   * Получаем в итоге списки:
       * `order_house` - *Хозы с Наименованием, Артикулом, Уп\Шт и Количетвом*
       * `order_tea` - *Чаи с Наименованием и количеством*
       * `order_wd` - Позиции хозов и чаев с количеством для Лубянки
       * `order_wdl` - Позиции хозов и чаев с количеством для Сухаревки
 
 4. С помощью библиотеки `openpyxl` создает виртуальную таблицу, в которою заносит полученные значения
 и выравнивает текст
 
 
 5. Создает Excel-файл `Order.xlsx` со списками заказов `Хозтоваров` и `Чаёв` на оба заведения
 \+ общие списки для `WD` и `WDL` и сохраняет данные в нём
 
 
 6. После сохранения открывает файл `Order.xlsx`

## Установка программы
Для работы программы у вас должны быть установлены
* Python
* Git

###Cкачиваем программу с GitHub:

Ссылка : `https://github.com/IgorKonel/InventoryGreenDoor.git`

Команда для Git : `git clone https://github.com/IgorKonel/InventoryGreenDoor.git`

В рабочей директории запускаем файл `Install.bat`

### Подготовка к запуску

1. Заполнить в Google Sheets лист `Invent WD/ZD` по всем трём заведениям

2. Выставить нужное число в соответствующей вкладке

3. Проверить на наличие пустых ячеек, исправить 

## Запуск программы

Запустите файл Inventory.bat

### Создание ключей доступа

> На Google Cloud Platform создаем ключи доступа для нашего приложения.
> 
> Они нужны для идентификации приложения. В данной программе мы пользуемся только API key
> 
> Проект под названием Inventory создан на почту `indooracivity@gmail.com`


### Описание файлов

`Inventory.bat`- скрипт для запуска через консоль

`Order.xlsx` - Excel-файл, который создается по итогу работы программы.
(*До первого запуска в папке отсутствует*)

`req.txt` - список всех библиотек, нужных для работы программы

`venv` - папка с установленными библиотеками для виртуальной среды (отсутствует в Git)
> Будет установлена после запуска `Install.bat`

`creds` - пакет с ключами (отсутствует в Git)

`creds/__init__.py` - содержит в себе API key (отсутствует в Git)

Выглядит так:

```python
__all__ = ['api_key']

api_key = "put_your_api_key"
```

`main.py` - файл основной программы

`REDADME` - содержит описание поставленных задач

`.gitignore` -список файлов и директорий, который игнорируется системой Git
